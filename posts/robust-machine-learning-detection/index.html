<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Robust Machine Learning - Detection" /><meta property="og:locale" content="en_US" /><meta name="description" content="Relevant papers: [J3, C4]." /><meta property="og:description" content="Relevant papers: [J3, C4]." /><link rel="canonical" href="https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/" /><meta property="og:url" content="https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/" /><meta property="og:site_name" content="Konstantinos Konstantinidis" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-28T18:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Robust Machine Learning - Detection" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Robust Machine Learning - Detection","dateModified":"2023-11-25T03:48:37+00:00","datePublished":"2021-11-28T18:00:00+00:00","description":"Relevant papers: [J3, C4].","url":"https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/"},"@context":"https://schema.org"}</script><title>Robust Machine Learning - Detection | Konstantinos Konstantinidis</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Konstantinos Konstantinidis"><meta name="application-name" content="Konstantinos Konstantinidis"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/kostas_files/KonstantinidisPhoto.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Konstantinos Konstantinidis</a></div><div class="site-subtitle font-italic">Ph.D. <br> Iowa State University</div></div><div class="sidebar-bottom d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/kkonstantinidis" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://scholar.google.com/citations?user=pLi_5zwAAAAJ&hl=en" aria-label="scholar" target="_blank" rel="noopener"> <i class="fas fa-graduation-cap"></i> </a> <a href="https://www.linkedin.com/in/konstantinos-konstantinidis-33187252/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/research/" class="nav-link"> <i class="fa-fw fas fa-flask ml-xl-3 mr-xl-3 unloaded"></i> <span>RESEARCH</span> </a><li class="nav-item"> <a href="/industry/" class="nav-link"> <i class="fa-fw fas fa-briefcase ml-xl-3 mr-xl-3 unloaded"></i> <span>INDUSTRY</span> </a><li class="nav-item"> <a href="/teaching/" class="nav-link"> <i class="fa-fw fas fa-chalkboard-teacher ml-xl-3 mr-xl-3 unloaded"></i> <span>TEACHING</span> </a><li class="nav-item"> <a href="/courses/" class="nav-link"> <i class="fa-fw fas fa-book-reader ml-xl-3 mr-xl-3 unloaded"></i> <span>COURSES</span> </a><li class="nav-item"> <a href="/awards/" class="nav-link"> <i class="fa-fw fas fa-award ml-xl-3 mr-xl-3 unloaded"></i> <span>AWARDS</span> </a><li class="nav-item"> <a href="/volunteering/" class="nav-link"> <i class="fa-fw fas fa-hands-helping ml-xl-3 mr-xl-3 unloaded"></i> <span>VOLUNTEERING</span> </a></ul></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Robust Machine Learning - Detection</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Robust Machine Learning - Detection</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Konstantinos Konstantinidis </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Nov 28, 2021, 6:00 PM +0000" >Nov 28, 2021<i class="unloaded">2021-11-28T18:00:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Nov 24, 2023, 7:48 PM -0800" >Nov 24, 2023<i class="unloaded">2023-11-25T03:48:37+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="905 words">5 min read</span></div></div><div class="post-content"><p>Relevant papers: [<a href="/research/">J3</a>, <a href="/research/">C4</a>].</p><p>The following article examines the problem of <em>Byzantine</em> behavior in distributed learning setups from the lens of detection. The problem has been introduced in another <a href="/posts/robust-machine-learning-filtering/">article</a> discussing our previously proposed method <em>ByzShield</em>. In this work, our objective is to initially attempt to detect which nodes behave adversarially or erroneously before resorting to gradient aggregation. We consider attack models ranging from strong ones: $q$ omniscient adversaries with full knowledge of the defense protocol that can change from iteration to iteration to weak ones: $q$ randomly chosen adversaries with limited collusion abilities which only change every few iterations at a time. Our algorithms rely on redundant task assignments coupled with the detection of adversarial behavior. Specifically, we consider clusters of $K$ workers, where each gradient task is assigned to $r$ of them.</p><p>We consider two different task assignment schemes, named <em>Aspis</em> and <em>Aspis+</em>. Aspis is a subset-based scheme and enjoys the most benefits in adversarial settings: omniscient, colluding adversaries, up to $q$ adversaries that can change at each iteration. However, Aspis requires large batch sizes (in the mini-batch SGD). It is <a href="https://arxiv.org/abs/1606.04838" target="_blank" rel="noopener">well-recognized</a> that large batch sizes often cause performance degradation in training. Accordingly, for this class of attacks, we present a different algorithm called Aspis+ that can work with much smaller batch sizes. For Aspis+, we use <a href="https://link.springer.com/book/10.1007/b97564" target="_blank" rel="noopener">combinatorial designs</a> to assign the gradient tasks to workers. Aspis+ is a good fit for clusters that suffer from non-adversarial failures that can lead to inaccurate gradients.</p><p>For Aspis, we devised a strong attack against the method and proved that it is optimal for distorting as many files as possible. Even in this adverse scenario, our method enjoys a reduction in the fraction of corrupted gradients of more than 90% compared with the prior state-of-the-art <a href="https://papers.nips.cc/paper/9220-detox-a-redundancy-based-framework-for-faster-and-more-robust-gradient-aggregation" target="_blank" rel="noopener">DETOX</a>. A weaker variation of this attack is where the adversaries do not collude and act randomly. In this case, we demonstrate that the Aspis protocol allows for detecting all the adversaries. In both scenarios, we provide theoretical guarantees on the fraction of corrupted gradients; Figure 1 shows a simulation of the distortion fraction and compares it with the baseline method (that assigns one gradient to each worker) as well as <a href="https://papers.nips.cc/paper/9220-detox-a-redundancy-based-framework-for-faster-and-more-robust-gradient-aggregation" target="_blank" rel="noopener">DETOX</a>, under optimal attacks.</p><p><img data-proofer-ignore data-src="/kostas_files/distortion_fig_107.png" alt="Figure 1" width="400" /> <em>Figure 1: Distortion fraction of optimal attacks for $(K,r)=(50,3)$ and comparison.</em></p><p>The detection mechanism of Aspis is based on clique-finding in appropriate graphs. In our setup, the edges of the utilized graphs encode the agreements among the workers. A <em>clique</em> in an undirected graph is defined as a subset of vertices with an edge between any pair of them. A <em>maximal clique</em> is one that cannot be enlarged by adding additional vertices to it. A <em>maximum clique</em> is one such that there is no clique with more vertices in the given graph. In our papers, we prove that the honest workers form a clique of size $K-q$. The clique containing the honest workers may not be maximal. However, it will have a size of at least $K-q$. Any worker with degree less than $K-q-1$ will not belong to a maximum clique, and we show that it can be eliminated immediately as a “detected” adversary. Let us consider a cluster of $K=7$ workers. An example of successful detection of the adversarial nodes $U_1$, $U_2$, and $U_3$ where the maximum clique is unique and of size $K-q = 4$ is in Figure 2. However, if there are multiple maximum cliques in the graph, the ambiguity as to which one is the honest set makes an accurate detection impossible; in this case, we resort to robust aggregation, i.e., the method of gradient filtering discussed in the previous <a href="/posts/robust-machine-learning-filtering/">article</a>. An example of this case is shown in Figure 3.</p><p><img data-proofer-ignore data-src="/kostas_files/Subset_assignment_K7_r3_graph_success.png" alt="Figure 2" width="200" /> <em>Figure 2: Unique max-clique in the detection graph, detection succeeds.</em></p><p><img data-proofer-ignore data-src="/kostas_files/Subset_assignment_K7_r3_graph_failure.png" alt="Figure 3" width="200" /> <em>Figure 3: Two max-cliques in the detection graph, detection fails.</em></p><p>We note that clique-finding is well-known to be an NP-complete problem (<em>cf.</em> [<a href="https://link.springer.com/chapter/10.1007/978-1-4684-2001-2_9" target="_blank" rel="noopener">Karp, 1972</a>]). Nevertheless, there are fast, practical algorithms with excellent performance on graphs even up to hundreds of nodes (we used that of [<a href="https://www.sciencedirect.com/science/article/pii/S0304397506003586" target="_blank" rel="noopener">Etsuji et al., 2006</a>]) that is implemented in the Python <a href="https://networkx.org/documentation/stable/index.html" target="_blank" rel="noopener">NetworkX</a> package. Our extensive experimental evidence suggests that clique-finding is not a computation bottleneck for the size and structure of the graphs that Aspis uses. We have experimented with clique-finding on a graph of $K=100$ workers and $r=5$ for different values of $q$; in all cases, enumerating all maximal cliques took no more than $15$ milliseconds.</p><p>For weaker attacks considered for Aspis+, i.e., when the adversaries change only every few iterations, our results indicate that our scheme detects all adversaries within approximately $5$ iterations. The principal intuition of the Aspis+ detection approach is to iteratively keep refining a graph in which the edges encode the agreements of workers until the degree of some nodes falls below a value; we prove that the workers whose degree falls below $K-q-1$ are Byzantine.</p><p>We present top-1 classification accuracy experiments on the <a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10</a> data set for various gradient distortion attacks coupled with choice/behavior patterns of the adversarial nodes. Under the most sophisticated distortion methods such as <a href="https://papers.nips.cc/paper/9069-a-little-is-enough-circumventing-defenses-for-distributed-learning" target="_blank" rel="noopener">ALIE</a>, the performance gap between Aspis/Aspis+ and other state-of-the-art methods is substantial, e.g., for Aspis, it is $43\%$ in the strong scenario (<em>cf.</em> Figure 4), and for Aspis+, $19\%$ in the weak scenario (<em>cf.</em> Figure 5).</p><p><img data-proofer-ignore data-src="/kostas_files/top1_fig_94.png" alt="Figure 4" width="400" /> <em>Figure 4: ALIE distortion under optimal attack scenarios, coordinate-wise median-based defenses, CIFAR-10, K=15.</em></p><p><img data-proofer-ignore data-src="/kostas_files/top1_fig_111.png" alt="Figure 5" width="400" /> <em>Figure 5: ALIE distortion under weak attack scenarios (random Byzantines), coordinate-wise median-based defenses, CIFAR-10, K=15.</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/research/'>Research</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Robust Machine Learning - Detection - Konstantinos Konstantinidis&url=https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Robust Machine Learning - Detection - Konstantinos Konstantinidis&u=https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Robust Machine Learning - Detection - Konstantinos Konstantinidis&url=https://kkonstantinidis.github.io//posts/robust-machine-learning-detection/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/aggregated-mapreduce/"><div class="card-body"> <span class="timeago small" >Nov 28, 2021<i class="unloaded">2021-11-28T18:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Aggregated MapReduce</h3><div class="text-muted small"><p> Relevant papers: [J2], [C2]. We have extended our coded scheme for a general MapReduce framework to a class of distributed algorithms, broadly used in deep learning, where intermediate computation...</p></div></div></a></div><div class="card"> <a href="/posts/coding-&-distributed-computing/"><div class="card-body"> <span class="timeago small" >Nov 28, 2021<i class="unloaded">2021-11-28T18:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Coding & Distributed Computing</h3><div class="text-muted small"><p> Relevant papers: [J2], [C1]. Big data analytics often require distributed implementations in which clusters process a sheer amount of data. Hadoop MapReduce and Apache Spark are examples of such f...</p></div></div></a></div><div class="card"> <a href="/posts/robust-machine-learning-filtering/"><div class="card-body"> <span class="timeago small" >Nov 28, 2021<i class="unloaded">2021-11-28T18:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Robust Machine Learning - Filtering</h3><div class="text-muted small"><p> Relevant paper: [C3]. In this work, we examine distributed deep learning setups in which computing devices may return adversarial or erroneous computations. This behavior is called Byzantine and i...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/coding-&-distributed-computing/" class="btn btn-outline-primary" prompt="Older"><p>Coding & Distributed Computing</p></a> <a href="/posts/robust-machine-learning-filtering/" class="btn btn-outline-primary" prompt="Newer"><p>Robust Machine Learning - Filtering</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/kkonstantinidis">Konstantinos Konstantinidis</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
